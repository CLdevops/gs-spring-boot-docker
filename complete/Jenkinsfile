node {
  def project = 'gs-spring-boot-docker'
  def dockerhubuser = 'bash2docker'
  def imageTag = "${dockerhubuser}/${project}:${env.BUILD_NUMBER}"

  stage('Image Creation') { // for display purposes
     // Get some code from a GitHub repository
     git 'https://github.com/CLdevops/gs-spring-boot-docker.git'
     sh "echo ${project}"
     sh "echo ${dockerhubuser}"
     sh "echo ${imageTag}"
	 // Run the maven build
	 
	 if (isUnix()) {
        sh "cd complete && ./mvnw install dockerfile:build"
		
     }
	 withDockerRegistry([ credentialsId: "b89f3b96-11ff-4050-88c0-d812ce5460a5", url: "" ]) {
         sh "echo ${imageTag}"
         sh "docker tag springio/gs-spring-boot-docker:latest ${imageTag}"
         sh "docker push ${imageTag}"
     }
  }
   
  }
